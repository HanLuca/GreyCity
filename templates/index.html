<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grey City: Apocalypse</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modules/index.css') }}">
</head>
<body>
    <div class="layoutWrapper">
        <div class="gameContainer">
            <header class="statusBar">
                <div class="statusItem">HP: <span id="hpVal">--</span> / <span id="maxHpVal">--</span></div>
                <div class="statusItem"><span id="locName">System Init...</span></div>
            </header>
            <div id="gameLog" class="gameLog"></div>
            <div class="controlPanel"><div id="actionButtons" class="buttonGroup"></div></div>
        </div>

        <div class="sidePanel">
            <div class="side-section">
                <div class="panelHeader">
                    <span>:: NAVIGATION ::</span>
                    <button class="action-btn" id="navBtnSettings">‚öôÔ∏è SETTINGS</button>
                </div>
                <div class="mapWrapper"><div id="miniMap" class="miniMapGrid"></div></div>
            </div>
            
            <div class="side-section inventory-section">
                <div class="panelHeader">
                    <span>:: INVENTORY ::</span>
                    <button class="action-btn" id="navBtnArchive">üìú ARCHIVE</button>
                </div>
                
                <div class="inventory-tabs">
                    <button class="inv-tab active" data-category="all">ALL</button>
                    <button class="inv-tab" data-category="weapon">WPN</button>
                    <button class="inv-tab" data-category="consumable">USE</button>
                    <button class="inv-tab" data-category="material">MAT</button>
                    <button class="inv-tab" data-category="important">KEY</button>
                </div>

                <div id="inventoryList" class="inventoryContainer">
                    <div class="emptyMsg">Í∞ÄÎ∞©Ïù¥ ÎπÑÏóàÏäµÎãàÎã§.</div>
                </div>
            </div>
            
            <div class="side-section status-section">
                <div class="panelHeader status-header">
                    <span class="status-title">:: STATUS ::</span>
                    <button class="action-btn" id="navBtnUpgrade">ü´Ä UPGRADE</button>
                </div>

                <div class="systemInfo">
                    <div class="stat-card">
                        <div class="stat-grid">
                            <div class="stat-box">
                                <div class="stat-label">ATTACK</div>
                                <div class="stat-val atk-val" id="atkVal">10</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-label">EVASION</div>
                                <div class="stat-val eva-val"><span id="evaVal">0.0</span><span class="percent">%</span></div>
                            </div>
                        </div>
                        <div class="heart-box">
                            <span class="heart-icon">ü´Ä</span>
                            <span class="heart-label">HEART PIECE :</span>
                            <span id="fragVal" class="heart-val">0</span>
                        </div>
                    </div>

                    <div class="user-card">
                        <div class="user-info-row">
                            <p class="user-name-wrapper">USER:<span class="user-name">{{ username }}</span></p>
                            <span class="levelText">LV.<span id="levelVal">1</span></span>
                        </div>
                        <div class="expContainer"><div id="expBar" class="expFill"></div></div>
                        <div class="exp-text">EXP: <span id="expVal">0</span> / <span id="maxExpVal">100</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content settings-modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-title cyan-title">‚öôÔ∏è SYSTEM SETTINGS</h2>
            
            <div class="settings-list">
                <span class="settings-label">COMMUNICATION</span>
                <div class="settings-comm-group">
                    <button class="settings-btn comm-btn-notice" id="btnOpenNotice">üì¢ Í≥µÏßÄÏÇ¨Ìï≠</button>
                    <button class="settings-btn comm-btn-message" id="btnOpenMessage">‚úâÔ∏è Î©îÏÑ∏ÏßÄÌï®</button>
                </div>
                
                <hr class="settings-divider">

                <span class="settings-label">PREFERENCES</span>
                <button disabled class="settings-btn">
                    <span>üîä ÏÇ¨Ïö¥Îìú ÏÑ§Ï†ï</span><span class="settings-desc">[ÏßÄÏõê ÏòàÏ†ï]</span>
                </button>
                <button disabled class="settings-btn">
                    <span>üñ•Ô∏è ÌôîÎ©¥ Ìö®Í≥º</span><span class="settings-desc">[ÏßÄÏõê ÏòàÏ†ï]</span>
                </button>

                <hr class="settings-divider">
                
                <span class="settings-label">DATA MANAGEMENT</span>
                <button id="btnResetAccount" class="btn-reset">‚ö†Ô∏è Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî</button>
                <button id="btnDeleteAccount" class="btn-delete-acc">‚ò†Ô∏è Í≥ÑÏ†ï ÏòÅÍµ¨ ÏÇ≠Ï†ú</button>

                <hr class="settings-divider">
                <span class="settings-label">ACCOUNT</span>
                <a href="/logout" class="logout-link">
                    <button class="btn-logout">[ SYSTEM LOGOUT ]</button>
                </a>
            </div>
        </div>
    </div>

    <div id="upgradeModal" class="modal">
        <div class="modal-content upgrade-modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-title pink-title">ü´Ä BODY UPGRADE</h2>
            <div id="upgradeList"></div>
        </div>
    </div>

    <div id="archiveModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-title cyan-title">üìÇ SURVIVAL LOGS</h2>
            <div id="archiveList" class="archive-list-container"></div>
        </div>
    </div>

    <div id="noticeModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-title cyan-title">üì¢ SYSTEM NOTICES</h2>
            <div id="noticeList" class="comm-list-container"></div>
        </div>
    </div>

    <div id="messageModal" class="modal">
        <div class="modal-content msg-modal-content">
            <span class="close">&times;</span>
            <h2 class="modal-title msg-title">‚úâÔ∏è INBOX</h2>
            <div id="messageList" class="comm-list-container"></div>
        </div>
    </div>

    <div id="itemModal" class="modal">
        <div class="modal-content item-modal-content">
            <div id="modalTopAccent" class="modal-top-accent"></div>
            <div class="modal-inner-padding">
                <div class="modal-item-header">
                    <span id="modalItemType" class="modal-item-type">TYPE</span>
                    <span class="close close-btn-cross">&times;</span>
                </div>
                <h2 id="modalItemName" class="modal-item-name">Item Name</h2>
                <div class="modal-item-stat-wrapper">
                    <div id="modalItemStat" class="modal-item-stat">Stat Info</div>
                </div>
                <div id="modalItemDesc" class="modal-item-desc">Item Description</div>
                <div class="modal-drop-info">
                    <div class="modal-drop-row">üåç <span class="drop-label">Ïä§Ìè∞ Ïû•ÏÜå:</span> <span id="modalItemDropLoc" class="drop-val">Î™®Îì† Í≥≥</span></div>
                    <div>üé≤ <span class="drop-label">Ïä§Ìè∞ ÌôïÎ•†:</span> <span id="modalItemDropRate" class="drop-rate-val">10%</span></div>
                </div>
                
                <div id="modalUpgradeSection" class="modal-upgrade-section hidden">
                    <div class="modal-upgrade-label">‚öôÔ∏è Ïû•ÎπÑ Í∞ïÌôî</div>
                    <div class="modal-upgrade-row">
                        <span class="upgrade-material-label">ÏïÑÎ¨¥ Ïû¨Î£å ÏïÑÏù¥ÌÖú</span>
                        <span id="upgMetalVal" class="modal-upgrade-val">0 / 0</span>
                    </div>
                    <div class="modal-upgrade-row margin-bottom">
                        <span class="upgrade-material-label">Ïã¨Ïû• Ï°∞Í∞Å</span>
                        <span id="upgFragVal" class="modal-upgrade-val">0 / 0</span>
                    </div>
                    <button id="modalBtnUpgrade" class="modal-btn-upgrade">Í∞ïÌôî Ïã§Ìñâ</button>
                </div>

                <div class="modal-btn-group">
                    <button id="modalBtnUse" class="modal-btn-use"></button>
                    <button id="modalBtnDisassemble" class="modal-btn-disassemble hidden">Î∂ÑÌï¥</button>
                    <button id="modalBtnDiscard" class="modal-btn-discard">Î≤ÑÎ¶¨Í∏∞</button>
                </div>
            </div>
        </div>
    </div>

    <div id="locationModal" class="modal">
        <div class="modal-content loc-modal-content">
            <div id="locModalTopAccent" class="modal-top-accent"></div>
            
            <div class="modal-inner-padding">
                <div class="loc-header">
                    <div class="loc-header-top">
                        <span id="modalLocName" class="loc-title">Ïû•ÏÜå Ïù¥Î¶Ñ</span>
                        <span class="close close-btn-cross">&times;</span>
                    </div>
                    <div class="loc-meta">
                        <span id="modalLocCoord" class="loc-coord">X:0 Y:0</span>
                        <span id="modalLocStatus"></span>
                    </div>
                </div>
                
                <div id="modalLocDesc" class="loc-desc">ÏÑ§Î™Ö</div>
                <div id="modalLocInfo"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/modules/index.js') }}"></script>
</body>
</html>